<section class="padding" fxFill fxLayoutAlign="center center">
    <mat-card fxLayout="column" fxFlex="1 1 calc(100% - 20px)" fxLayoutAlign="center center" fxLayoutGap="20px">
        <mat-card-header>
            <mat-card-title>
                <h3>{{ titulo }}</h3>
            </mat-card-title>
        </mat-card-header>
        <mat-card-content fxFill>
            <form [formGroup]="formularioActividad" fxFill (ngSubmit)="onDesicionCreacionOEditar()">
                <div fxLayoutGap="40px" fxLayout="column">
                    <!-- Datos básicos de la actividad -->
                    <div fxLayout="row" fxLayoutGap="60px">
                        <!-- Indicador, periodicidad, unidad -->
                        <div fxLayout="column" fxLayoutGap="20px" fxFlex="1 1 calc(50% - 60px)">
                            <!-- Indicador -->
                            <mat-form-field>
                                <mat-label>Indicador</mat-label>
                                <input matInput formControlName="indicador">
                            </mat-form-field>
                            <!-- Descripción de la actividad -->
                            <mat-form-field fxLayout="column">
                                <mat-label>Descripción de la actividad</mat-label>
                                <textarea class="bordes-curvos" matInput type="text" id="descripcionActividad" formControlName="descripcionActividad" (keyup)="onKey($event)" [maxlength]="500"></textarea>
                                <div fxLayout="row" fxLayoutAlign="end end">
                                    <!-- <div>
                                        <mat-error *ngIf="descripcion.invalid">
                                            Campo <strong>requerido</strong>
                                        </mat-error>
                                    </div> -->
                                    <span><strong>{{contador}}</strong> de 500 caracteres</span>
                                </div>
                            </mat-form-field>
                            <!-- Periocidad -->
                            <mat-form-field>
                                <mat-label>Periodicidad</mat-label>
                                <mat-select formControlName="periodicidad">
                                    <mat-option *ngFor="let periodicidad of listadoPeriocidad" [value]="periodicidad.descripcion">
                                        {{periodicidad.descripcion}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                            <!-- Unidad -->
                            <div fxLayout="row" fxLayoutGap="20px">
                                <mat-label fxFlex="20%">Unidad</mat-label>
                                <mat-radio-group fxFlex="60%" fxLayoutGap="20px" id="tipo_unidad" formControlName="tipo_unidad" aria-label="tipo_unidad">
                                    <mat-radio-button *ngFor="let options of listaCheck" [value]="options.value">
                                        {{ options.descripcion }}
                                    </mat-radio-button>
                                </mat-radio-group>
                                <input matInput fxFlex="20%" type="number" formControlName="valor_unidad" placeholder="1" min="1" style="border: 1px solid;">
                            </div>
                        </div>
                        <!-- Recurso, fechas -->
                        <div fxLayout="column" fxLayoutGap="20px" fxFlex="1 1 calc(50% - 60px)">
                            <!-- Recurso -->
                            <mat-form-field>
                                <mat-label>Recursos</mat-label>
                                <mat-select formControlName="recurso">
                                    <mat-option *ngFor="let recurso of listadoRecursos" [value]="recurso.descripcion">
                                        {{recurso.descripcion}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                            <!-- Fecha ejecución -->
                            <mat-form-field>
                                <mat-label>Fecha de inicio de la actividad</mat-label>
                                <input matInput id="fechaejecucion" placeholder="Fecha de ejecución" formControlName="fechaEjecucion" [matDatepicker]="fechaejecucion" [min]="fechaInicio" [max]="fechaFinal" readonly />
                                <mat-datepicker-toggle matSuffix [for]="fechaejecucion"></mat-datepicker-toggle>
                                <mat-datepicker #fechaejecucion></mat-datepicker>
                            </mat-form-field>
                            <!-- Fecha de terminación -->
                            <mat-form-field>
                                <mat-label>Fecha de terminación de la actividad</mat-label>
                                <input matInput id="fechaTerminacion" placeholder="Fecha de terminación de la actividad" formControlName="fechaTerminacion" [matDatepicker]="fechaTerminacion" [min]="fechaActual" readonly />
                                <mat-datepicker-toggle matSuffix [for]="fechaTerminacion"></mat-datepicker-toggle>
                                <mat-datepicker #fechaTerminacion></mat-datepicker>
                            </mat-form-field>
                            <!-- Fecha de seguimiento -->
                            <mat-form-field>
                                <mat-label>Fecha de seguimiento</mat-label>
                                <input matInput id="fechaSeguimiento" placeholder="Fecha de seguimiento" formControlName="fechaSeguimiento" [matDatepicker]="fechaSeguimiento" [min]="fechaActual" readonly />
                                <mat-datepicker-toggle matSuffix [for]="fechaSeguimiento"></mat-datepicker-toggle>
                                <mat-datepicker #fechaSeguimiento></mat-datepicker>
                            </mat-form-field>
                        </div>
                    </div>
                    <!-- Asignación de responsable -->
                    <div fxLayout="row" fxLayoutGap="20px">
                        <!-- Tabla responsable -->
                        <div fxFlex="80%">
                            <mat-card>
                                <mat-card-title> Asignar responsable </mat-card-title>
                                <mat-card-content fxLayout="column" fxLayoutGap="30px">
                                    <div fxLayout="row" fxLayoutAlign="space-between center">
                                        <mat-form-field>
                                            <input matInput [placeholder]="'Filtrar responsable'" (keyup)="onAplicarFiltroItems($event)" #input />
                                        </mat-form-field>
                                    </div>

                                    <table mat-table [dataSource]="dataSource">

                                        <!-- nombre Column -->
                                        <ng-container matColumnDef="nombre">
                                            <th mat-header-cell *matHeaderCellDef> Nombre </th>
                                            <td mat-cell *matCellDef="let element"> {{element.nombre}} </td>
                                        </ng-container>

                                        <!-- cargo Column -->
                                        <ng-container matColumnDef="cargo">
                                            <th mat-header-cell *matHeaderCellDef> Cargo </th>
                                            <td mat-cell *matCellDef="let element"> {{element.cargo}} </td>
                                        </ng-container>

                                        <!-- Checkbox Column -->
                                        <ng-container matColumnDef="select">
                                            <th mat-header-cell *matHeaderCellDef>Opciones</th>
                                            <td mat-cell *matCellDef="let row">
                                                <mat-checkbox [disabled]="mostrarBtnVolver" (click)="$event.stopPropagation()" (change)="$event ? onSeleccionarUnicaFila(row) : null" [checked]="selection.isSelected(row)"></mat-checkbox>
                                        </ng-container>

                                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                        <tr mat-row *matRowDef="let row; columns: displayedColumns;">
                                        </tr>
                                    </table>
                                    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
                                </mat-card-content>
                            </mat-card>
                        </div>
                        <!-- Botón de guardar -->
                        <div fxFlex="20%" fxLayoutAlign="center center">
                            <div fxLayout="row" fxLayoutGap="30px" fxLayoutAlign="center center" *ngIf="!mostrarBtnVolver">
                                <button mat-raised-button type="submit" color="primary">
                              {{ nombreBoton }}
                            </button>
                                <button mat-raised-button type="button" (click)="volver()" color="warn">
                              Cancelar
                            </button>
                            </div>
                            <div *ngIf="mostrarBtnVolver" fxLayoutAlign="center center">
                                <button mat-raised-button type="button" (click)="volver()" color="primary">
                              Volver
                            </button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </mat-card-content>
    </mat-card>
</section>